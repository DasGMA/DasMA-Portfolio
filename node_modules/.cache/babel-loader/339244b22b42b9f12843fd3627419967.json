{"ast":null,"code":"import _classCallCheck from \"/home/das/Desktop/DasMA-Portfolio/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/das/Desktop/DasMA-Portfolio/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/das/Desktop/DasMA-Portfolio/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/das/Desktop/DasMA-Portfolio/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/das/Desktop/DasMA-Portfolio/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/das/Desktop/DasMA-Portfolio/src/Components/Blog/Blog.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { Route } from 'react-router-dom';\nimport { Container } from 'react-materialize';\nimport BlogPostView from './BlogPostView';\nimport decode from 'jwt-decode';\nimport BlogPostList from './BlogPostList';\nimport EditBlogPost from './EditBlogPost';\nimport Admin from './Admin';\nimport NewBlogPost from './NewBlogPost';\nvar URL = 'http://ma:9000/posts';\n\nvar Blog =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Blog, _Component);\n\n  function Blog(props) {\n    var _this;\n\n    _classCallCheck(this, Blog);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Blog).call(this, props));\n\n    _this.getPosts = function () {\n      axios.get(URL).then(function (response) {\n        _this.setState({\n          posts: response.data,\n          searchPosts: response.data\n        });\n      }).catch(function (error) {\n        console.log(error);\n      });\n    };\n\n    _this.handleSearch = function (event) {\n      _this.setState({\n        search: event.target.value,\n        posts: _this.state.searchPosts.filter(function (post) {\n          return new RegExp(event.target.value, \"i\").exec(post.title);\n        })\n      });\n    };\n\n    _this.newPost = function () {\n      _this.props.history.push(\"\".concat(_this.props.match.url, \"/posts/new-post\"));\n    };\n\n    _this.adminLogin = function () {\n      _this.props.history.push(\"\".concat(_this.props.match.url, \"/admin-login\"));\n    };\n\n    _this.getToken = function () {\n      return localStorage.getItem('token');\n    };\n\n    _this.logout = function () {\n      localStorage.removeItem('token');\n\n      _this.setState({\n        adminLoggedIn: false\n      });\n    };\n\n    _this.loggedIn = function () {\n      var token = _this.getToken();\n\n      if (!!token && !_this.isTokenExpired(token)) {\n        _this.setState(function (prevState) {\n          return {\n            adminLoggedIn: !prevState.adminLoggedIn\n          };\n        });\n      }\n    };\n\n    _this.isTokenExpired = function (token) {\n      try {\n        var decoded = decode(token);\n\n        if (decoded.exp < Date.now() / 10000) {\n          return true;\n        } else {\n          return false;\n        }\n      } catch (error) {\n        return false;\n      }\n    };\n\n    _this.back = function () {\n      _this.props.history.push('/blog');\n    };\n\n    _this.state = {\n      posts: [],\n      search: '',\n      searchPosts: [],\n      adminLoggedIn: false\n    };\n    return _this;\n  }\n\n  _createClass(Blog, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getPosts();\n      this.loggedIn();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          posts = _this$state.posts,\n          search = _this$state.search;\n      return React.createElement(Container, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, this.state.adminLoggedIn ? React.createElement(\"button\", {\n        onClick: this.newPost,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }, \"New Post\") : null, this.state.adminLoggedIn ? React.createElement(\"button\", {\n        onClick: this.logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, \"Logout\") : React.createElement(\"button\", {\n        onClick: this.adminLogin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, \"Admin Login\"), React.createElement(Route, {\n        exact: true,\n        path: \"\".concat(this.props.match.path),\n        render: function render(props) {\n          return React.createElement(BlogPostList, Object.assign({}, props, {\n            posts: posts,\n            handleSearch: _this2.handleSearch,\n            search: search,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 107\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"\".concat(this.props.match.path, \"/post/:id\"),\n        render: function render(props) {\n          return React.createElement(BlogPostView, Object.assign({}, props, {\n            posts: posts,\n            back: _this2.back,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 111\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"\".concat(this.props.match.path, \"/post/edit-post/:id\"),\n        render: function render(props) {\n          return React.createElement(EditBlogPost, Object.assign({}, props, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 115\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"\".concat(this.props.match.path, \"/post/new-post\"),\n        component: NewBlogPost,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"\".concat(this.props.match.path, \"/admin-login\"),\n        component: Admin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Blog;\n}(Component);\n\nexport default Blog;","map":{"version":3,"sources":["/home/das/Desktop/DasMA-Portfolio/src/Components/Blog/Blog.js"],"names":["React","Component","axios","Route","Container","BlogPostView","decode","BlogPostList","EditBlogPost","Admin","NewBlogPost","URL","Blog","props","getPosts","get","then","response","setState","posts","data","searchPosts","catch","error","console","log","handleSearch","event","search","target","value","state","filter","post","RegExp","exec","title","newPost","history","push","match","url","adminLogin","getToken","localStorage","getItem","logout","removeItem","adminLoggedIn","loggedIn","token","isTokenExpired","prevState","decoded","exp","Date","now","back","path"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport axios from 'axios';\r\nimport { Route } from 'react-router-dom';\r\nimport { Container} from 'react-materialize';\r\nimport BlogPostView from './BlogPostView';\r\nimport decode from 'jwt-decode';\r\nimport BlogPostList from './BlogPostList';\r\nimport EditBlogPost from './EditBlogPost';\r\nimport Admin from './Admin';\r\nimport NewBlogPost from './NewBlogPost';\r\n\r\nconst URL = 'http://ma:9000/posts';\r\n\r\nclass Blog extends Component {\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            posts: [],\r\n            search: '',\r\n            searchPosts: [],\r\n            adminLoggedIn: false\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.getPosts();\r\n        this.loggedIn();\r\n    }\r\n\r\n    getPosts = () => {\r\n        axios.get(URL)\r\n        .then(response => {\r\n            this.setState({\r\n                posts: response.data,\r\n                searchPosts: response.data\r\n            })\r\n        })\r\n        .catch(error => {\r\n          console.log(error);\r\n        });\r\n    }\r\n\r\n    handleSearch = (event) => {\r\n        this.setState ({\r\n          search: event.target.value,\r\n          posts: this.state.searchPosts.filter((post) => \r\n            new RegExp(event.target.value, \"i\").exec(post.title))\r\n        });\r\n    }\r\n\r\n    newPost = () => {\r\n       this.props.history.push(`${this.props.match.url}/posts/new-post`);\r\n    }\r\n\r\n    adminLogin = () => {\r\n        this.props.history.push(`${this.props.match.url}/admin-login`);\r\n    }\r\n\r\n    getToken = () => {\r\n        return localStorage.getItem('token');\r\n    }\r\n\r\n    logout = () => {\r\n        localStorage.removeItem('token');\r\n        this.setState({\r\n            adminLoggedIn: false\r\n        })\r\n    }\r\n\r\n    loggedIn = () => {\r\n        const token = this.getToken();\r\n        if (!!token && !this.isTokenExpired(token)) {\r\n            this.setState(prevState => ({\r\n                adminLoggedIn: !prevState.adminLoggedIn\r\n            }));\r\n        }\r\n    }\r\n\r\n    isTokenExpired = (token) => {\r\n        try {\r\n            const decoded = decode(token);\r\n            if (decoded.exp < Date.now() / 10000) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n        catch (error) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n\r\n    back = () => {\r\n        this.props.history.push('/blog');\r\n    }\r\n    \r\n\r\n    render() {\r\n        const { posts, search } = this.state;\r\n        return (\r\n            <Container>\r\n                { this.state.adminLoggedIn ? <button onClick = {this.newPost}>New Post</button> : null }\r\n                { this.state.adminLoggedIn ? <button onClick = {this.logout}>Logout</button> : <button onClick = {this.adminLogin}>Admin Login</button> }\r\n\r\n                <Route exact path = {`${this.props.match.path}`} render = {(props) => (\r\n                    <BlogPostList {...props} posts = {posts} handleSearch = {this.handleSearch} search = {search} />\r\n                )} />\r\n                \r\n                <Route path = {`${this.props.match.path}/post/:id`} render = {(props) => (\r\n                    <BlogPostView {...props} posts = {posts} back = {this.back}/>\r\n                )} />\r\n\r\n                <Route path = {`${this.props.match.path}/post/edit-post/:id`} render = {(props) => (\r\n                    <EditBlogPost {...props} />\r\n                )} />\r\n\r\n                <Route path = {`${this.props.match.path}/post/new-post`} component = { NewBlogPost } />\r\n\r\n                <Route path = {`${this.props.match.path}/admin-login`} component = { Admin } />\r\n\r\n            </Container>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Blog;"]},"metadata":{},"sourceType":"module"}